{"version":3,"file":"contentScriptStart.js","sources":["../../src/pages/DefaultPopup/components/LocalStorageSetter/contentScriptStart.ts"],"sourcesContent":["import { WssConfig } from \"@/constants\";\r\nconst WSS_CONFIG = \"WSS_CONFIG\";\r\n\r\n// 跳过登录\r\nconst skipLoginFunc = () => {\r\n  let __PMS_CONSOLE__TEMP__: any;\r\n  // 用来获取 user.type 绕过环境变化的提示 不然在项目级每次切换都会触发弹窗\r\n  const currentUser = window.localStorage.getItem(\"currentUser\") || \"{}\";\r\n  const currentUserObj = JSON.parse(currentUser);\r\n\r\n  Object.defineProperty(window, \"__PMS_CONSOLE__\", {\r\n    get: function () {\r\n      return __PMS_CONSOLE__TEMP__;\r\n    },\r\n    set: function (newVal) {\r\n      if (newVal?.user) {\r\n        // 去除这个属性 User类中只有get set会报错\r\n        const newCurrentUserObj = { ...currentUserObj };\r\n        delete newCurrentUserObj.businessTypeTitle;\r\n        // 有些应用是根据 __PMS_CONSOLE__.user 获取组织信息，所以需要填充到user上面\r\n        Object.assign(newVal?.user, {\r\n          ...newCurrentUserObj,\r\n          login: () => {},\r\n        });\r\n        // console.log(\"跳过登录设置成功-----------\");\r\n      }\r\n      __PMS_CONSOLE__TEMP__ = newVal;\r\n    },\r\n  });\r\n};\r\n\r\n(() => {\r\n  const wssConfigObj = window.localStorage.getItem(WSS_CONFIG) || \"{}\";\r\n\r\n  const { skipPmsLogin } = JSON.parse(wssConfigObj) as WssConfig;\r\n  if (skipPmsLogin) {\r\n    skipLoginFunc();\r\n  }\r\n})();\r\n"],"names":["WSS_CONFIG","skipLoginFunc","__PMS_CONSOLE__TEMP__","currentUser","currentUserObj","newVal","newCurrentUserObj","wssConfigObj","skipPmsLogin"],"mappings":"AACA,MAAMA,EAAa,aAGbC,EAAgB,IAAM,CACtB,IAAAC,EAEJ,MAAMC,EAAc,OAAO,aAAa,QAAQ,aAAa,GAAK,KAC5DC,EAAiB,KAAK,MAAMD,CAAW,EAEtC,OAAA,eAAe,OAAQ,kBAAmB,CAC/C,IAAK,UAAY,CACR,OAAAD,CACT,EACA,IAAK,SAAUG,EAAQ,CACrB,GAAIA,GAAA,MAAAA,EAAQ,KAAM,CAEV,MAAAC,EAAoB,CAAE,GAAGF,GAC/B,OAAOE,EAAkB,kBAElB,OAAA,OAAOD,GAAA,YAAAA,EAAQ,KAAM,CAC1B,GAAGC,EACH,MAAO,IAAM,CAAC,CAAA,CACf,EAGqBJ,EAAAG,CAC1B,CAAA,CACD,CACH,GAEC,IAAM,CACL,MAAME,EAAe,OAAO,aAAa,QAAQP,CAAU,GAAK,KAE1D,CAAE,aAAAQ,CAAiB,EAAA,KAAK,MAAMD,CAAY,EAC5CC,GACYP,GAElB,GAAG"}